## 帖子详情模块接口文档（v1）

> 适用范围：图文/视频/文章详情页统一使用。  
> 类型约定：`postType` 为数字，`1=图文`，`2=视频`，`3=文章`。
> 身份标识约定：全链路统一使用 `memberId`。

---

### 1) 获取帖子详情

- **接口**：`GET /api/app/v1/post/detail`
- **说明**：获取单条帖子详情，前端根据 `postType` 渲染对应详情页。

#### Query 参数

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| postId | string \| number | 是 | 帖子ID |
| postType | number | 否 | 帖子类型，`1=图文`，`2=视频`，`3=文章`。联调阶段建议透传，保证返回结构与入口一致 |

#### 成功响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": "350785364797",
    "postType": 1,
    "type": "dynamic",
    "title": "",
    "content": "今天天气真好，出门散步拍了一些照片，分享给大家～",
    "coverImage": "https://example.com/cover.jpg",
    "images": [
      "https://example.com/1.jpg",
      "https://example.com/2.jpg",
      "https://example.com/3.jpg",
      "https://example.com/4.jpg"
    ],
    "videoUrl": "",
    "videoCover": "",
    "author": {
      "id": 1001,
      "memberId": 1001,
      "nickname": "熊币元",
      "avatar": "https://example.com/avatar.jpg",
      "badge": "优质创作者"
    },
    "isFollowed": false,
    "isLiked": false,
    "isFavorited": false,
    "likeCount": 27,
    "favoriteCount": 28,
    "commentCount": 26,
    "createTime": "2026-02-27T12:30:00.000Z"
  }
}
```

---

### 2) 获取帖子评论列表（分页）

- **接口**：`GET /api/app/v1/post/comments`
- **说明**：获取帖子评论，返回统一分页结构。

#### Query 参数

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| postId | string \| number | 是 | 帖子ID |
| page | number | 否 | 页码，从1开始，默认 `1` |
| pageSize | number | 否 | 每页条数，默认 `20` |

#### 成功响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": "350785364797_comment_1",
        "postId": "350785364797",
        "memberId": 101,
        "parentCommentId": null,
        "nickname": "墨雨云",
        "avatar": "https://example.com/avatar.jpg",
        "content": "太赞了！",
        "createTime": "2026-02-27T12:30:00.000Z",
        "likeCount": 12,
        "isLiked": false,
        "replies": [
          {
            "id": "350785364797_comment_1_reply_1",
            "postId": "350785364797",
            "memberId": 201,
            "parentCommentId": "350785364797_comment_1",
            "nickname": "小风",
            "avatar": "https://example.com/avatar-2.jpg",
            "content": "同感，支持一下",
            "createTime": "2026-02-27T13:00:00.000Z",
            "likeCount": 3,
            "isLiked": false
          }
        ]
      }
    ],
    "total": 36,
    "page": 1,
    "pageSize": 20
  }
}
```

---

### 3) 发表评论

- **接口**：`POST /api/app/v1/post/comment`
- **说明**：在帖子详情页发表评论。

#### Body 参数

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| postId | string \| number | 是 | 帖子ID |
| content | string | 是 | 评论内容 |
| parentCommentId | string \| number | 否 | 回复评论时传入父评论ID；不传表示评论帖子 |

#### 成功响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": "350785364797_comment_1740632222222",
    "postId": "350785364797",
    "memberId": 1,
    "parentCommentId": null,
    "nickname": "我",
    "avatar": "https://example.com/avatar.jpg",
    "content": "写得真好",
    "createTime": "2026-02-27T12:45:00.000Z",
    "likeCount": 0,
    "isLiked": false
  }
}
```

---

### 4) 点赞评论

- **接口**：`POST /api/app/v1/post/comment/like`
- **说明**：点赞一条评论（评论区右侧点赞按钮使用）。

#### Body 参数

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| commentId | string \| number | 是 | 评论ID |

> `commentId` 来源：`GET /api/app/v1/post/comments` 返回的评论项 `id`。  
> - 点赞根评论：取 `data.list[i].id`  
> - 点赞回复：取 `data.list[i].replies[j].id`

#### 成功响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

---

### 5) 取消点赞评论

- **接口**：`POST /api/app/v1/post/comment/unlike`
- **说明**：取消点赞一条评论。

#### Body 参数

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| commentId | string \| number | 是 | 评论ID |

> `commentId` 来源同上（评论列表返回的 `id` 字段）。

#### 成功响应示例

```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

---

### 6) 列表接口字段补充（必须）

以下帖子列表接口都必须返回 `postType`：

- `/api/app/v1/follow/followMemberPosts`
- `/api/app/v1/follow/recommendPosts`
- `/api/app/v1/post/feed`
- `/api/app/v1/member/posts`
- `/api/app/v1/member/favorites`

`postType` 取值：
- `1` 图文
- `2` 视频
- `3` 文章
